function Address(e,t,n,r){function i(){return this.street+" "+this.city+" "+this.state+" "+this.zip}this.street=e;this.city=t;this.state=n;this.zip=r;this.getFormatted=i}var googleMapsURL="https://maps.googleapis.com/maps/api/geocode/json",homeLocation={get:function(){var e={};e.lat=localStorage.getItem("lat");e.lon=localStorage.getItem("lon");return e},set:function(e,t){localStorage.setItem("lat",e);localStorage.setItem("lon",t)}},ajax={xmlhttp:new XMLHttpRequest,callback:"",onReadyChangeState:function(){console.log("ajax.onReadyChangeState fired");ajax.xmlhttp.readyState===4&&ajax.xmlhttp.status===200&&ajax.callback(JSON.parse(ajax.xmlhttp.responseText))},get:function(e,t){console.log("ajax.get fired");ajax.callback=t;ajax.xmlhttp.onreadystatechange=ajax.onReadyChangeState;ajax.xmlhttp.open("GET",e,!0);ajax.xmlhttp.send();ajax.xmlhttp.setRequestHeader()}},locationInterface={getLocation:function(){console.log("locationInterface.getLocation Fired");navigator.geolocation.getCurrentPosition(this.getLocationSuccess,this.getError)},getLocationSuccess:function(e){console.log("locationInterface.getLocationSuccess Fired");document.querySelector("#lat").innerHTML=e.coords.latitude;document.querySelector("#lon").innerHTML=e.coords.longitude;console.log(this);locationInterface.doReverseLookup(e)},getError:function(e){console.log("getError Fired");console.log(e)},doReverseLookup:function(e){console.log("locationInterface.doReverseLookup Fired");var t=e.coords.latitude+","+e.coords.longitude;ajax.get(googleMapsURL+"?sensor=false&latlng="+t,locationInterface.doReverseLookupSuccess)},doReverseLookupSuccess:function(e){console.log("locationInterface.doReverseLookupSuccess Fired");var t=e.results[0];document.querySelector("#address").innerHTML=t.formatted_address}},distanceInterface={setDistanceReadout:function(e,t){document.querySelector("#d_km").innerHTML=e;document.querySelector("#d_miles").innerHTML=t},setDevicePosition:function(e,t){document.querySelector("#lat-device").innerHTML=e;document.querySelector("#lon-device").innerHTML=t}},settingsInterface={reportHomeLocation:function(e,t){document.querySelector("#lat").innerHTML=e;document.querySelector("#lon").innerHTML=t},getAddress:function(){var e=new Address;e.street=document.querySelector("#address").value;e.city=document.querySelector("#city").value;e.state=document.querySelector("#state").value;e.zip=document.querySelector("#zip").value;return e}},pictureInterface={displayImage:function(e){var t=document.getElementById("latest");t.src=e;t.style.display="inline"}},compassInterface={rotateCompass:function(e){var t=document.querySelector("#compass");t.style.webkitTransform="rotate("+e+"deg)"}},distanceModule={getLocation:function(){navigator.geolocation.getCurrentPosition(distanceModule.getLocationSuccess,distanceModule.getLocationError);console.log("getLocation Fired")},getLocationError:function(e){console.log("getLocationError Fired");console.log(e)},getLocationSuccess:function(e){var t=e.coords.latitude,n=e.coords.longitude,r=homeLocation.get(),i=r.lat,s=r.lon;distanceInterface.setDevicePosition(t,n);console.log("lat_device:",t);console.log("lon_device:",n);console.log("lat_home:",i);console.log("lon_home:",s);var o=Math.round(distanceModule.calcDistanceBetween(t,n,i,s)),u=Math.round(distanceModule.calcDistanceBetween(t,n,i,s,"miles"));distanceInterface.setDistanceReadout(o,u)},toRad:function(e){return e*Math.PI/180},calcDistanceBetween:function(e,t,n,r,i){typeof i=="undefined"&&(i="km");var s=6371;i==="miles"&&(s=3958.7558657440545);var o=distanceModule.toRad(n-e),u=distanceModule.toRad(r-t),a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(distanceModule.toRad(e))*Math.cos(distanceModule.toRad(n))*Math.sin(u/2)*Math.sin(u/2),f=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),l=s*f;return l}},settings={computeHomeLocation:function(e){e.preventDefault();var t=settingsInterface.getAddress();ajax.get(googleMapsURL+"?sensor=false&address="+t.getFormatted(),settings.doLookupSuccess)},setHomeLocationHere:function(e){e.preventDefault();navigator.geolocation.getCurrentPosition(settings.getLocationSuccess,settings.getLocationError)},getLocationSuccess:function(e){console.log("getLocationSuccess Fired");var t=e.coords.latitude,n=e.coords.longitude;homeLocation.set(t,n);settingsInterface.reportHomeLocation(t,n)},getLocationError:function(e){console.log("getLocationError Fired");console.log(e)},doLookupSuccess:function(e){console.log(e.results[0].geometry.location);var t=e.results[0].geometry.location.lat,n=e.results[0].geometry.location.lng;homeLocation.set(t,n);settingsInterface.reportHomeLocation(t,n)}},picture={onError:function(e){console.log(e.message)},getPicture:function(e){e.preventDefault();navigator.device.capture.captureImage(picture.onGetImageSuccess,picture.onError,{limit:1})},onGetImageSuccess:function(e){var t=e[0].fullPath;pictureInterface.displayImage(t)}},compass={lastReading:0,watchID:null,onError:function(e){console.log(e.message)},startWatch:function(){var e={frequency:100};compass.watchID=navigator.compass.watchHeading(compass.onSuccess,compass.onError,e)},stopWatch:function(){if(compass.watchID){navigator.compass.clearWatch(compass.watchID);compass.watchID=null}},onSuccess:function(e){var t=document.getElementById("heading");compass.changeHeading(e.magneticHeading)},changeHeading:function(e){var t=e,n=Math.abs(compass.lastReading-e);console.log("numberToTravelTo: "+t);console.log("delta: "+n);if(n>2){n>180&&(t-=360);compassInterface.rotateCompass(compass.flipSign(t));compass.lastReading=t}},flipSign:function(e){return e*-1}};